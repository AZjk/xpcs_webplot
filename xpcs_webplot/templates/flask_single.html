<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>{{ mydata.title }} - XPCS Results</title>
  <style>
    body {
      margin: 0px;
      margin-top: 0px;
      padding: 0px;
      font-family: Arial, Helvetica, sans-serif;
      background-color: #f5f5f5;
    }

    nav {
      display: flex;
      position: sticky;
      top: 0;
      width: 100%;
      background-color: rgb(133, 244, 116);
      overflow: auto;
      height: auto;
      opacity: 0.9;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .left-links {
      flex: 1 1 200px;
    }

    .links {
      display: inline-block;
      text-align: center;
      padding: 14px;
      color: #000000;
      text-decoration: none;
      font-size: 16px;
      font-weight: bolder;
    }

    .links:hover {
      border-bottom: 2px solid purple;
    }

    .selected {
      border-bottom: 2px solid purple;
    }

    .back-button {
      background-color: rgba(255, 255, 255, 0.3);
      margin: 5px;
      border-radius: 4px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .section {
      background-color: white;
      margin-bottom: 20px;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .section h2 {
      margin-top: 0;
      color: #333;
      border-bottom: 2px solid #1bc0dd;
      padding-bottom: 10px;
    }

    .image-container {
      text-align: center;
      margin: 20px 0;
    }

    .image-container img {
      max-width: 100%;
      height: auto;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th,
    td {
      text-align: left;
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }

    tr:nth-child(even) {
      background-color: #f8f9fa;
    }

    tr:hover {
      background-color: #e9ecef;
    }

    th {
      background-color: #da8bc1;
      color: white;
      font-size: 16px;
    }

    .nested-table {
      margin: 0;
      border: none;
      box-shadow: none;
    }

    .nested-table td {
      padding: 5px 10px;
      border: none;
    }

    .nested-table tr:nth-child(even) {
      background-color: transparent;
    }

    .correlation-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .correlation-item {
      text-align: center;
    }

    .correlation-item img {
      width: 100%;
      height: auto;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .correlation-item p {
      margin-top: 5px;
      font-size: 14px;
      color: #666;
    }
  </style>
</head>

<body>
  <nav>
    <div class="left-links">
      <a class="links back-button" href="/">‚Üê Back to Dashboard</a>
      <a class="links" href="#">{{ mydata.title }}</a>
    </div>
    <div class="right-links">
      <a class="links" href="#scattering">Scattering</a>
      <a class="links" href="#stability">Stability</a>
      <a class="links" href="#correlation-g2">Correlation-g2</a>
      <a class="links" href="#correlation-c2">Correlation-c2</a>
      <a class="links" href="#metadata">Metadata</a>
    </div>
  </nav>

  <div class="container">
    <div id="scattering" class="section">
      <h2>Scattering</h2>
      <div class="image-container">
        <img src="/static/{{ mydata.scattering }}" alt="Scattering plot">
      </div>
    </div>

    <div id="stability" class="section">
      <h2>Stability</h2>
      <div class="image-container">
        <img src="/static/{{ mydata.stability }}" alt="Stability plot">
      </div>
    </div>

    {% if mydata.correlation_g2 %}
    <div id="correlation-g2" class="section">
      <h2>Correlation - g2</h2>
      <div class="correlation-grid">
        {% for img in mydata.correlation_g2 %}
        <div class="correlation-item">
          <img src="/static/{{ img }}" alt="Correlation g2">
          <p>{{ img.split('/')[-1] }}</p>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    {% if mydata.correlation_c2 %}
    <div id="correlation-c2" class="section">
      <h2>Correlation - c2</h2>
      <div class="correlation-grid">
        {% for img in mydata.correlation_c2 %}
        <div class="correlation-item">
          <img src="/static/{{ img }}" alt="Correlation c2">
          <p>{{ img.split('/')[-1] }}</p>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <div id="metadata" class="section">
      <h2>Metadata</h2>
      <table>
        <thead>
          <tr>
            <th>Key</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody>
          {% for key, val in mydata.metadata.items() %}
          <tr>
            <td><strong>{{ key }}</strong></td>
            <td>
              {% if val is mapping %}
                <table class="nested-table">
                  {% for sub_key, sub_val in val.items() %}
                  <tr>
                    <td><strong>{{ sub_key }}:</strong></td>
                    <td>{{ sub_val }}</td>
                  </tr>
                  {% endfor %}
                </table>
              {% else %}
                {{ val }}
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <script>
    // Smooth scrolling for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Highlight active section in navigation
    const sections = document.querySelectorAll('.section');
    const navLinks = document.querySelectorAll('.right-links .links');

    window.addEventListener('scroll', () => {
      let current = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= sectionTop - 100) {
          current = section.getAttribute('id');
        }
      });

      navLinks.forEach(link => {
        link.classList.remove('selected');
        if (link.getAttribute('href') === `#${current}`) {
          link.classList.add('selected');
        }
      });
    });
  </script>
</body>

</html>
